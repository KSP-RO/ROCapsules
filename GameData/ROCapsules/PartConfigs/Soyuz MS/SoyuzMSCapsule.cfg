PART
{
	name = ROC-SoyuzMSCapsule
	module = Part
	author = DECQ
	
	RSSROConfig = True

	//	============================================================================
	//	Model and Dimensions
	//	============================================================================

	MODEL
	{
		model = ROCapsules/Assets/DECQ/SoyuzMS/SA
	}

	INTERNAL
	{
		name = ROC-SoyuzMSCapsuleInternal
	}

	scale = 1.0
	rescaleFactor = 1.0

	node_stack_top = 0.0, 1.037, 0.0, 0.0, 1.0, 0.0, 2
	node_stack_bottom = 0.0, -0.8, 0.0, 0.0, -1.0, 0.0, 2
	node_stack_periscope = 0.0, 0.1247507, -0.989488, 0.0, -1.0, 0.0, 1
	node_stack_parahute = 0.5, 0.5, 0.5, 0.0, -1.0, 0.0, 1
	node_stack_parahuteRezerv = -0.5, 0.5, 0.5, 0.0, -1.0, 0.0, 1
	node_attach = 0.0, 0.0, 0.0, 0.0, -1.0, 0.0

	CoPOffset = 0, 0.4, 0.0	
	CoMOffset = 0.0, -0.1, 0.08275

	buoyancy = 1.3

	attachRules = 1,0,1,1,0

	//	============================================================================
	//	Title, Description, Category, Techs
	//	============================================================================

	TechRequired = unlockParts
	cost = 150
	entryCost = 1
	category = Pods
	subcategory = 0
	title = Soyuz MS Descent Module
	manufacturer = RKK Energia
	description = The Soyuz Descent Module (SA) is where the crew sits during both ascent and reentry. It's equipped with basic life support, RCS for control during reentry and landing engines for softening the landing. Another notable feature is the offset COM, which allows the pod to generate lifting force during reentry and allow a small degree of control over it's landing zone.
	tags = soyuz ms, DECQ

	vesselType = Ship
	stagingIcon = COMMAND_POD
	CrewCapacity = 3
	bulkheadProfiles = size2

	//	=============================================================================
	//	Thermo, Durability
	//	=============================================================================

	mass = 2.45
	dragModelType = default
	maximum_drag = 0.25
	minimum_drag = 0.15
	angularDrag = 2
	crashTolerance = 12
	breakingTorque = 200
	breakingForce = 200
	maxTemp = 873.15
	skinMaxTemp = 2773.15
	emissiveConstant = 0.6
	thermalMassModifier = 1.0
	skinMassPerArea = 4

	//	============================================================================
	//	Animations and Textures
	//	============================================================================

	EFFECTS
	{
		rcs
		{
			AUDIO_MULTI_POOL
			{
				channel = Ship
				transformName = DPO_M
				clip = sound_rocket_mini
				volume = 0.0 0.0
				volume = 0.02 0.1
				volume = 0.5 0.1
				volume = 1.0 0.1
				pitch = 0.0 0.75
				pitch = 1.0 1.5
				loop = true
			}
			MODEL_MULTI_PARTICLE
			{
				modelName = Squad/FX/Monoprop_small
				transformName = DPO_M
				emission = 0.0 0.0
				emission = 0.1 0.0
				emission = 1.0 1.0
				speed = 0.0 0.8
				speed = 1.0 1.0
				localRotation = -90, 0, 0
			}
		}
	}

	//	============================================================================
	//	Modules and Resources
	//	============================================================================

	MODULE
	{
		name = ModuleCommand
		minimumCrew = 0
		RESOURCE
		{
			name = ElectricCharge
			rate = 0.35
		}
	}

	MODULE
	{
		name = ModuleSAS
		SASServiceLevel = 3
	}

	MODULE
	{
		name = AdjustableCoMShifter
		DescentModeCoM = 0.0, 0.0, -0.1
	}

	MODULE
	{
		name = ModuleScienceContainer
		reviewActionName = Review Stored Data
		storeActionName = Store Experiments
		storageRange = 3.125
	}

	MODULE
	{
		name = ModuleEnginesRF
		thrustVectorTransformName = thrustTransform
		EngineType = SolidBooster
		allowShutdown = False
		throttleLocked = True
		useEngineResponseTime = False
		engineAccelerationSpeed = 0
		fxOffset = 0, 0, 0.35
	}

	MODULE
	{
		name = ModuleEngineConfigs
		type = ModuleEngines
		configuration = SLE-M
		CONFIG
		{
			name = SLE-M
			minThrust = 30
			maxThrust = 30
			heatProduction = 100
			ullage = False
			pressureFed = False
			ignitions = 1
			IGNITOR_RESOURCE
			{
				name = ElectricCharge
				amount = 0.6
			}
			PROPELLANT
			{
				name = HTPB
				ratio = 1.0
				DrawGauge = True
			}
			atmosphereCurve
			{
				key = 0 250
				key = 1 230
			}
		}
	}

	MODULE
	{
		name = ModuleSurfaceFX
		thrustProviderModuleIndex = 0
		fxMax = 0.75
		maxDistance = 50
		falloff = 1.8
		thrustTransformName = thrustTransform
	}

	MODULE
	{
		name = ModuleRCSFX
		stagingEnabled = False
		thrusterTransformName = DPO_M
		thrusterPower = 0.147
		resourceFlowMode = STAGE_PRIORITY_FLOW
		runningEffectName = rcs

		PROPELLANT
		{
			name = HTP
			ratio = 1.0
		}

		atmosphereCurve
		{
			key = 0 280
			key = 1 144
			key = 4 0.001
		}
	}

	MODULE
	{
		name = ModuleJettison
		jettisonName = Cylinder_079
		bottomNodeName = top
		isFairing = False
		jettisonedObjectMass = 0.001
		jettisonForce = 3
		jettisonDirection = 3 0 0
	}

	MODULE:NEEDS[RasterPropMonitor]
	{
		name = RasterPropMonitorComputer
		storedStrings = v 0.2.0.0|06.11.2016|	Soyuz	|SOYUZ-TMA|(MODIFIED)|SQD0A4012-A1|MK1|		 DECQ   &   Dragon
	}

	MODULE:NEEDS[ConnectedLivingSpace]
	{
		name = ModuleConnectedLivingSpace
		passable = True
		passableWhenSurfaceAttached = False
		surfaceAttachmentsPassable = False
		impassablenodes = bottom, periscope, parahute, parahuteRezerv
	}

	MODULE
		{
		name = ModuleFuelTanks
		type = ServiceModule
		volume = 36
		basemass = -1
		//	Avionics batteries 27 kWh.
		//	Supports the Soyuz SA for a free - flight duration of approximately 6 hours.
		TANK
		{
			name = ElectricCharge
			amount = 7500
			maxAmount = 7500
		}
		//	ACS propellant 40 Kg.
		TANK
		{
			name = HTP
			amount = 28
			maxAmount = 28
		}
		TANK
		{
			name = HTPB
			amount = 7
			maxAmount = 7
		}
	}
}

//	==================================================
//	TAC Life Support compatibility.
//	==================================================

@PART[ROC-SoyuzMSCapsule]:FOR[RealismOverhaul]:NEEDS[TacLifeSupport]
{
	@description ^= :$: Supports a crew of 3 for up to 48 hours.

	@mass -= 0.009

	@MODULE[ModuleFuelTanks]
	{
		@volume = 80

		//	Food (6 hours).
		TANK
		{
			name = Food
			amount = 4.4
			maxAmount = 4.4
		}
		//	Water (6 hours).
		TANK
		{
			name = Water
			amount = 2.9
			maxAmount = 2.9
		}
		//	Oxygen (48 hours).
		TANK
		{
			name = Oxygen
			amount = 3551.0
			maxAmount = 3551.0
		}
		//	Solid waste (capacity for 6 hours).
		TANK
		{
			name = Waste
			amount = 0
			maxAmount = 0.4
		}
		//	Liquid waste (capacity for 6 hours).
		TANK
		{
			name = WasteWater
			amount = 0
			maxAmount = 3.7
		}
		//	Carbon Dioxide (capacity for 48 hours).
		TANK
		{
			name = CarbonDioxide
			amount = 0
			maxAmount = 3068.9
		}
	}
}

//	================================================================================
//	Configure Internal Model
//	================================================================================

@PART[ROC-SoyuzMSCapsule]:AFTER[RealismOverhaul]
{
	@INTERNAL[Soyuz_cockpit]
	{
		%scaleAll = 1.25, 1.25, 1.25

		@MODULE[InternalSeat],*
		{
			%kerbalScale = 1.25, 1.25, 1.25
			%kerbalOffset = 0.0, 0.0, 0.0
			%kerbalEyeOffset = 0.0, 0.0, 0.0
		}
	}
}

//	================================================================================
//	Configure RealAntennas
//	================================================================================

@PART[ROC-SoyuzMSCapsule]:BEFORE[RealAntennas]
{
	!MODULE[ModuleDataTransmitter],* {}
	MODULE
	{
		name = ModuleRealAntenna
		referenceGain = 2.0
		RFBand = UHF		//Default to UHF-band
	}
}

//	================================================================================
//	Configure RealPlume
//	================================================================================

@PART[ROC-SoyuzMSCapsule]:FOR[RealPlume]:NEEDS[SmokeScreen]
{
	PLUME
	{
		name = Solid-Sepmotor
		transformName = thrustTransform
		localRotation = 0.0, 0.0, 0.0
		fixedScale = 1.0
		energy = 0.5
		speed = 1.0
		emissionMult = 0.5
		plumePosition = 0.0, 0.0, -0.1
		plumeScale = 0.8
		flarePosition = 0.0, 0.0, 0.0
		flareScale = 1.0
	}

	@MODULE[ModuleEngines*]
	{
		%powerEffectName = Solid-Sepmotor
		!runningEffectName = DELETE
	}

	@MODULE[ModuleEngineConfigs]
	{
		@CONFIG,*
		{
			%powerEffectName = Solid-Sepmotor
		}
	}
}
