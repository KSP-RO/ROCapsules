PART
{
	name = ROC-LEMDescentBDB
	module = Part
	author = CobaltWolf, capkirk123

	RSSROConfig = true

	//	============================================================================
	//	Model and Dimensions
	//	============================================================================

	MODEL
	{
		model = ROCapsules/Assets/BDB/Apollo/LM_DescentStage
	}

	scale = 1.0
	rescaleFactor = 1.5646

	node_stack_top = 0.0, 0.58759, 0.0, 0.0, 1.0, 0.0, 1
	node_stack_bottom = 0.0, -0.10226, 0.0, 0, -1, 0, 1
	//node_stack_bottom2 = 0.0, -0.37979, 0.0, 0, -1, 0, 1

	stackSymmetry = 3

	NODE
	{
		name = legAttach_1
		transform = legNode_1
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = legAttach_2
		transform = legNode_2
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = legAttach_3
		transform = legNode_3
		size = 1
		method = FIXED_JOINT
	}
	NODE
	{
		name = legAttach_4
		transform = legNode_4
		size = 1
		method = FIXED_JOINT
	}
	// stack, srfAttach, allowStack, allowSrfAttach, allowCollision
	attachRules = 1,0,1,1,0

	//	============================================================================
	//	Title, Description, Category, Techs
	//	============================================================================

	TechRequired = unlockParts
	cost = 150
	entryCost = 1
	category = FuelTank
	subcategory = 0
	title = Apollo LM Descent Stage
	manufacturer = #roMfrGrumman
	description = The Apollo Lunar Module descent stage. Equipped with storage boxes for storing equipment. It also includes a node to attach the Lunar Roving Vehicle.
	tags = apollo, moon, lunar, crew, armstrong, aldrin, cm, csm, saturn, v, lem, lm, module, descent, landing, land, legs

	bulkheadProfiles = size1, size2

	//	============================================================================
	//	Thermo, Durability
	//	============================================================================

	mass = 2.02
	crashTolerance = 14
	maxTemp = 673.15
	skinMaxTemp = 773.15
	emissiveConstant = 0.6
	thermalMassModifier = 1.0
	skinMassPerArea = 2.0
	buoyancy = 1.1
	breakingForce = 250
	breakingTorque = 250
	fuelCrossFeed = True

	//	============================================================================
	//	Modules and Resources
	//	============================================================================

	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = deflectorSwitch
		switcherDescription = Type
		switcherDescriptionPlural = Types
		SUBTYPE
		{
			name = Plume Deflectors
			transform = PlumeDeflectors
		}
		SUBTYPE
		{
			name = No Deflectors
		}
	}

	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = roverSwitch
		switcherDescription = Variant
		switcherDescriptionPlural = Variants
		SUBTYPE
		{
			name = H Class
			transform = H_Class
		}
		SUBTYPE
		{
			name = J Class
			transform = J_Class
		}
	}

	// MODULE
	// {
		// name = ModuleB9PartSwitch
		// moduleID = meshSwitchFoil
		// switcherDescription = Foil
		// switcherDescriptionPlural = Foils
		// affectDragCubes = True
		// affectFARVoxels = True
		// SUBTYPE
		// {
			// name = Gold
		// }
		// SUBTYPE
		// {
			// name = Silver
			// TEXTURE
			// {
				// texture = ROCapsules/Assets/BDB/Apollo/Paint/Silver/bluedog_LM_Descent_Silver
				// currentTexture = bluedog_LM_Descent
			// }
			// TEXTURE
			// {
				// shaderProperty = _SpecMap
				// texture = ROCapsules/Assets/BDB/Apollo/Paint/Silver/bluedog_LM_Descent_Silver_Spec
				// currentTexture = bluedog_LM_Descent_Spec
			// }
		// }
	// }

	MODULE
	{
		name = FlagDecal
		textureQuadName = flagTransform1
	}

	MODULE
	{
		name = FlagDecal
		textureQuadName = flagTransform2
	}

	MODULE
	{
		name = ModuleFuelTanks
		type = ServiceModule
		volume = 8163
		basemass = -1

		//	Batteries ~56 kWh (28V @ 400 Ah).
		//	Four batteries for the H missions and five for J missions.

		TANK
		{
			name = ElectricCharge
			amount = 161280
			maxAmount = 201600
		}

		//	LMDE fuel mass ~3190 kg.
		//	Capacity for ~222 kg of extra fuel for the J missions.

		TANK
		{
			name = Aerozine50
			amount = 3544
			maxAmount = 3791
		}

		//	LMDE oxidizer mass ~5104 kg.
		//	Capacity for ~355 kg of extra oxidizer for the J missions.

		TANK
		{
			name = NTO
			amount = 3520
			maxAmount = 3765
		}
		
		TANK
		{
			name = Helium
			amount = 75231.6
			maxAmount = 80471.4
		}
	}
}

//	================================================================================
//	TAC Life Support Compatibility
//	================================================================================

@PART[ROC-LEMDescentBDB]:FOR[ROCapsules]:NEEDS[TacLifeSupport]
{
	@mass -= 0.194

	@MODULE[ModuleFuelTanks]
	{
		@volume += 310

		//	Two water tanks with a capacity of ~75 kg each (second tank for J missions).

		TANK
		{
			name = Water
			amount = 0
			maxAmount = 150
		}

		//	Two oxygen tanks with a capacity of ~22 kg each (second tank for J missions).

		TANK
		{
			name = Oxygen
			amount = 15441.4
			maxAmount = 30882.9
		}
	}
}
